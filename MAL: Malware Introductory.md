# MAL: Malware Introductory

## Understanding Malware Campaigns (Task 2)

Two types : Targeted and Mass Campaign

### Targeted

A "Targeted" attack is just that - targeted. In most cases, malware attacks that occur this way are created for a specific purpose against a specific target. A great example of this type of purpose could be the DarkHotel malware, whom is designed to steal information such as authentication details from government officials.

### Mass Campaign

Mass Campaign classification can be akin to many real life examples, and is the most common type of attacks. The entire purpose of this type of Malware is to infect as many devices as possible and perform whatever it may - regardless of target.

### What is the famous example of a targeted attack-esque Malware that targeted Iran?

    Stuxnet
    
### What is the name of the Ransomware that used the Eternalblue exploit in a "Mass Campaign" attack?

    Wannacry
    
## Identifying if a Malware Attack has Happened (Task 3)

### Process of a malware attack

* Delivery
* Execution
* Maintaining Persistence
* Persistence
* Propagation

Two categories of fingerprints : Host Based and Network Based.

### Name the first essential step of a Malware Attack?

    Delivery
    
### Now name the second essential step of a Malware Attack?

    Execution
    
### What type of signature is used to classify remnants of infection on a host?

    Host-based signatures
    
### What is the name of the other classification of signature used after a Malware attack?

    Network-based signatures
    
## Static Vs. Dynamic Analysis (Task 4)

### Static Analysis

> "Static Analysis" is used to gain a high-level abstraction of the sample - it can be fairly simple to decide if a piece of code is "malicious" or not with this method alone. At its core, this method is of the analysis of the sample at the state it presents itself as, without executing the code. Employing the use of techniques such as signature analysis via checksums means quick, efficient (albeit extremely brief) and safe analysis of malware.

### Dynamic Analysis

> "Dynamic Analysis" essentially involves executing the sample and observing what happens.It is the testing and evaluation of an application by examining the code without executing the application.

## Obtaining MD5 Checksums of Provided Files (Task 7)

> MD5 "Checksums" are a prominent attribute in the malware Community. Because there can be many variants of a family of Ransomware, these MD5 "Checksums" are cryptographic "fingerprints" of the files. This allows a uniformed identification throughout the community - especially with automated Sandboxes.

Identify the MD5 Checksums of the three files provided in "Task 7"

### The MD5 Checksum of aws.exe  

    D2778164EF643BA8F44CC202EC7EF157

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/5684ecaa-3670-4a3a-ad45-ff9063f6852b)

### The MD5 Checksum of Netlogo.exe

    59CB421172A89E1E16C11A428326952C

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/056b96b9-6ef6-4e11-a1b7-9ccbe5c1c5e3)

### The MD5 Checksum of vlc.exe

    5416BE1B8B04B1681CB39CF0E2CAAD9F

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/89b538b9-92ca-47c5-a067-60ad6044a56b)

## Now lets see if the MD5 Checksums have been analysed before (Task 8)

### Does Virustotal report this MD5 Checksum / file aws.exe as malicious?

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/47163f46-4681-4717-91a7-afc1fb97f10c)

### Does Virustotal report this MD5 Checksum / file Netlogo.exe as malicious?

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/6b57e7ab-3d65-4702-b1ac-cc4a54a66374)

### Does Virustotal report this MD5 Checksum / file vlc.exe as malicious?

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/fb33c122-ab83-498c-9802-1290500868b3)

## Identifying if the Executables are obfuscated / packed (Task 9)

ï»¿There are a few provided tools on this Windows instance that are capable of identifying the compiler / packer of a file. However, `PeID` has a huge database and is a great tool for this.

The hex value for an executable is always `4D 5A`

### What does PeID propose 1DE9176AD682FF.dll being packed with?

    Microsoft Visual C++ 6.0 DLL
    
Go to `Tools -> Static -> PE Tools -> PEiD`

Give the files that present in the `Task 9 in Tasks` folder.

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/f8f10652-669e-46b7-bec4-b824537818fb)

### What does PeID propose AD29AA1B.bin being packed with?

    Microsoft Visual C++ 6.0
    
![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/d792d56a-f5a0-4c49-a9d6-16a232b99611)

## What is Obfuscation / Packing? (Task 10)

Packing is one form of obfuscation that malware Authors employ to prevent the analysis of programmes. There are both legitimate and malicious reasons as to why the Author of a program will want to prevent the decompiling of their program

Malware Authors employ obfuscation techniques such as packing - whilst for the same reasons, they do so with the intent to prevent people like us reversing it to understand its behaviours and ultimately with the aims of achieving infection.

Run the PeID to the file in `Task 10`

### What packer does PeID report file "6F431F46547DB2628" to be packed with?

    FSG 1.0 -> dulek/xt
    
![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/be10ad30-57d0-4b70-aa45-dee1abf820a5)

## Visualising the Differences Between Packed & Non-Packed Code (Task 11)

Whilst PeID is capable of detecting the possibility of packers being used, it is not able to automatically de-obfuscate them. This is a process we will have to do manually - at a later stage.

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/39efa5ab-435c-4b3d-8a4d-a5948b142415)

After confirming that this file is indeed packed, let's open it up with a tool called `IDA Freeware`.

We can find the tool in `Tools -> Static -> Disassembly`

Open `Imports` tab 

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/faea3e1c-2762-4807-8ffa-7aab83bcc305)

We can see there are two Imports in this program.

We can explore futher with other tabs such as `IDA View-A`

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/4675c392-b375-4a4c-9ab7-1c26c50a28d8)

## Introduction to Strings (Task 12)

`Strings` are essentially the ASCII / Text contents of a program...this could be anything from passwords for self-extracting zips, to bitcoin addresses in ransomware samples.

Programs often contain large amount of strings and using the "strings" tool from sysinternals may only display 10% of these.

### What is the URL that is outputted after using "strings"

    practicalmalwareanalysis.com
    
Open `cmd` and enter `strings "C:\Users\Analysis\Desktop\Tasks\Task 12\67844C01"` in `cd C:\Users\Analysis\Desktop\Tools\SysinternalsSuite`

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/6da7446e-6461-4ff6-bd01-28899e31c40c)

### How many unique "Imports" are there?

    5
    
Launch the program `Tools -> Static -> PE Tools -> PE Explorer` 

Open `67844C01` from the Task 12 folder

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/4f2e30b0-1374-4289-b5d5-af1bbf174b95)

Go to `View` and select `Import`

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/44c2c6b2-eec8-4b32-9db6-887ded7c26cb)

##  Introduction to Imports (Task 13)

### Disassemblers

> Disassemblers reverse the compiled code of a program from machine code to human-readable instructions (assembly). This is limited to how the program represents itself in its current state! I.e. If the contents of an executable changes during execution - "Disassemblers" will not reflect this.

### Debuggers

> "Debuggers" essentially facilitate execution of the program - where the analyser can view the changes made throughout each "step" of the program. These tools are great because a true picture of the program presents itself. However, if it is indeed malicious, you have now infected yourself.

## How many references are there to the library "msi" in the "Imports" tab of IDA Freeware for "install.exe"

    9
    
Open `Tools -> Disassembly -> IDA Freeware`. Open the `install.exe` file.

Go to `Imports` tab and see the `msi` library category.

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/09275114-3465-4690-a672-c73ce9384c10)

## Practical Summary (Task 14)

Perform upon `ComplexCalculator.exe` in the tasks folder.

### What is the MD5 Checksum of the file?

    F5BD8E6DC6782ED4DFA62B8215BDC429

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/3295aaeb-5c11-48e6-ad0d-825fc1f83c38)

### Does Virustotal report this file as malicious?

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/fcae0a0c-ddcc-424d-9146-38192aed2498)

### Output the strings using Sysinternals "strings" tool. What is the last string outputted?

    d:h:

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/849822d0-720f-4471-96e3-8d75d3f489bd)

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/b0a87979-1c20-43ba-8326-0dfc9bb110e9)

### What is the output of PeID when trying to detect what packer is used by the file?

    Nothing Found

![image](https://github.com/tousif13/TryHackMe_Writeups/assets/33444140/5dda3efb-b27a-4125-a62d-ecc71a39673a)
